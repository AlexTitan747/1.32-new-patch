namespace = titanmor
#these are the event that change you government type and form 

#every time you reach a dev point you get a choice between a republic, theocracy or monarchy
#it gives you a specialised reform based on what you choose

#duchy rank
country_event = {
	id = titanmor.1
	title = "titanmor.title1"
	desc = "titanmor.desc1"
	picture = GOOD_WITH_MONARCH_eventPicture

	fire_only_once = yes
	
	trigger = {
		tag = MOR
		has_country_flag = wattasid_resolution
	}

	mean_time_to_happen = {
		months = 24
	}
	
	option = {
		name = "titanmor.event1"
		if = {
				limit = { is_revolutionary = no }
				add_government_reform = moroccan_monarchy
		}
		set_country_flag = a_time_of_change
	}
}

country_event = {
	id = titanmor.2
	title = "titanmor.title2"
	desc = "titanmor.desc2"
	picture = GOOD_WITH_MONARCH_eventPicture

	fire_only_once = yes

	trigger = {
		AND = {
			mission_completed = gc_mor_algiers 
			mission_completed = tm_mor_a_moroccan_armada
			mission_completed = gc_mor_tunis 
		}
	}


	mean_time_to_happen = {
		months = 1
	}
	
	option = {
		name = "titanmor.event2"

		set_country_flag = moors_selected
		custom_tooltip = mor_moors_choice_tt
		hidden_effect = {
			swap_non_generic_missions = yes

			upper_andalucia_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			lower_andalucia_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
		}
	}

	option = {
		name = "titanmor.event3"

		set_country_flag = maghreb_selected
		custom_tooltip = mor_maghrebs_choice_tt
		hidden_effect = {
			swap_non_generic_missions = yes
		}
	}

	option = {
		name = "titanmor.event4"
		change_religion = shiite
		set_country_flag = caliphate_selected
		custom_tooltip = mor_caliphate_choice_tt
		hidden_effect = {
			swap_non_generic_missions = yes
			every_owned_province = {
				limit = {
					religion_group = muslim
					NOT = {
						religion = shiite
					}
				}
				change_religion = shiite
			}
			change_ruling_family_religions_effect = { religion = shiite }
		}
	}
}

country_event = {
	id = titanmor.3
	title = "titanmor.title3"
	desc = "titanmor.desc3"
	picture = EXPLORERS_eventPicture

	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		OR = {
			tag = MOR
			was_tag = MOR
		}
		828 = {
			is_empty = yes
		}
	}

option = {
		name = "titanmor.event5"
		ai_chance = { factor = 1 }
		828 = {
			add_core = ROOT
			cede_province = ROOT
		}

	}
}
