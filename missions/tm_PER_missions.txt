###
# Persia Missions 
###

tm_PER_branch_1 = {
	slot = 1
	generic = no
	ai = yes

	has_country_shield = yes

	potential = {
		tag = PER
	}

	tm_PER_branch1_mission_1 = {
		icon = placeholder 
		position = 1
		required_missions = {}

		province_to_highlight = {
			province_id = 2213
		}

		trigger = {
			2213 = {
				owned_by = ROOT
				development = 25
			}
		}

		effect = {
			2213 = {
				add_permanent_province_modifier = {
					name = tm_PER_imperial_city
					duration = -1
				}
			}
		}
	}

	tm_PER_branch1_mission_2 = {
		icon = placeholder 
		position = 3
		required_missions = { tm_PER_branch1_mission_1 }

		provinces_to_highlight = {
			OR = {
				region = khorasan_region
				region = persia_region 
			}
			owned_by = PER
		}

		trigger = {
			num_of_owned_provinces_with = {
				development = 30 
				has_production_building = yes
				has_military_building = yes
				value = 3 
			}
		}

		effect = {
			custom_tooltip = tm_PER_imperial_cities_tt
			hidden_effect = {
				every_owned_province = {
					limit = {
						owned_by = PER
						development = 30
						has_production_building = yes
						has_military_building = yes
					}
					add_permanent_province_modifier = {
						name = tm_PER_imperial_city
						duration = -1
					}
				}
			}
		}
	}
	tm_PER_branch1_mission_3 = {
		icon = placeholder
		position = 4
		required_missions = {
			tm_PER_branch1_mission_2 
		}

		provinces_to_highlight = {
			area = farsistan_area
		}

		trigger = {
			farsistan_area = {
				type = all
				owned_by = ROOT
				development = 20
				NOT = { local_autonomy = 10 }
			}
		}

		effect = {
			country_event = {
				id = titanper.2
				tooltip = titanper.2.tt
			}
		}
	}
	tm_PER_branch1_mission_4 = {
		icon = placeholder
		position = 5
		required_missions = { tm_PER_branch2_mission_2 }
		
		provinces_to_highlight = {
			OR = {
				area = alania_area
				area = dagestan_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}

		trigger = {
			alania_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			dagestan_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}

		effect = {
			add_dip_power = 50
			add_prestige = 15
		}
	}
}

tm_PER_branch_2 = {
	slot = 2
	generic = no
	ai = yes

	has_country_shield = yes

	potential = {
		tag = PER
	}

	tm_PER_branch2_mission_1 = {
		icon = placeholder
		position = 3
		required_missions = { tm_PER_branch3_mission_1 }

		provinces_to_highlight = {
			OR = {
				area = ardabil_area
				area = tabriz_area
				area = shirvan_area
				area = armenia_area
				area = yerevan_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}

		trigger = {
			ardabil_area = {
				type = all
				owned_by = ROOT
			}
			tabriz_area = {
				type = all
				owned_by = ROOT
			}
			shirvan_area = {
				type = all
				owned_by = ROOT
			}
			armenia_area = {
				type = all
				owned_by = ROOT
			}
			yerevan_area = {
				type = all
				owned_by = ROOT
			}
		}

		effect = {
			country_event = {
				id = titanper.1 # Duchy of Armenia March, or Lose Autonomy and Culture Convert the Land

				tooltip = titanper.1.tt
			}
			if = {
				limit = { ARM = { is_subject_of_type_with_overlord = { who = PER type = march } } }
				kartli_kakheti_area = {				
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
						NOT = { is_core = ARM }
						NOT = { is_permanent_claim = ARM }
					}
					add_permanent_claim = ARM
				}
				imereti_area = {				
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
						NOT = { is_core = ARM }
						NOT = { is_permanent_claim = ARM }
					}
					add_permanent_claim = ARM
				}
				samtskhe_area = {				
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
						NOT = { is_core = ARM }
						NOT = { is_permanent_claim = ARM }
					}
					add_permanent_claim = ARM
				}
			}
			else = {
				kartli_kakheti_area = {				
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT
				}
				imereti_area = {				
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT
				}
				samtskhe_area = {				
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT
				}
			}
		}
	}

	tm_PER_branch2_mission_2 = {
		icon = placeholder
		position = 4
		required_missions = { tm_PER_branch2_mission_1 }

		provinces_to_highlight = {
			OR = {
				area = kartli_kakheti_area
				area = imereti_area
				area = samtskhe_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}

		trigger = {
			kartli_kakheti_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			imereti_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			samtskhe_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}

		effect = {
			if = {
				limit = { 421 = { NOT = { has_building = fort_15th }  } }
				421 = {
					add_building = fort_15th
				}
			}
			if = {
				limit = { 1856 = { NOT = { has_building = fort_15th }  } }
				1856 = {
					add_building = fort_15th
				}
			}
			else = {
				add_treasury = 400
			}
			erzurum_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			bayazid_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			alania_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			dagestan_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
		}
	}

	tm_PER_branch2_mission_3 = {
		icon = placeholder 
		position = 5
		required_missions = { tm_PER_branch2_mission_2 }

		provinces_to_highlight = {
			OR = {
				area = erzurum_area
				area = bayazid_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}

		trigger = {
			erzurum_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			bayazid_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}

		effect = {
			add_adm_power = 50
			add_mercantilism = 10
		}
	}

	tm_PER_branch2_mission_4 = {
		icon = placeholder 
		position = 6
		required_missions = { 
			tm_PER_branch1_mission_4 
			tm_PER_branch2_mission_3
		}

		trigger = {
			caucasia_region = {
				type = all
				owned_by = ROOT
			}
		}
		
		effect = {
			add_power_projection = {
				type = tm_PER_conqueror_of_the_caucasus
				amount = 20
			}
			custom_tooltip = tm_PER_caucasus_pp_perma_TT

			add_adm_power = 75
			add_dip_power = 75
			add_mil_power = 75
			add_treasury = 500
		}
	}
}

tm_PER_branch_3 = {
	slot = 3
	generic = no
	ai = yes

	has_country_shield = yes

	potential = {
		tag = PER
	}

	tm_PER_branch3_mission_1 = {
		icon = placeholder
		position = 2
		required_missions = { tm_PER_branch4_mission_1 }

		provinces_to_highlight = {
			area = azerbaijan_area 
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}

		trigger = {
			azerbaijan_area = {
				type = all
				owned_by = ROOT
			}
		}

		effect = {
			add_prestige = 10
			add_adm_power = 50
		}
	}
	tm_PER_branch3_mission_2 = {
		icon = placeholder
		position = 3
		required_missions = { tm_PER_branch4_mission_2 }

		provinces_to_highlight = {
			area = farsistan_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}

		trigger = {
			farsistan_area = {
				type = all
				owned_by = ROOT
			}
		}

		effect = {
			add_treasury = 10
		}
	}
	tm_PER_branch3_mission_3 = {
		icon = placeholder
		position = 4
		required_missions ={ tm_PER_branch3_mission_2 } 

		provinces_to_highlight = {
			OR = {
				area = persian_gulf_coast
				area = espakh_area 
				area = mogostan_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		trigger = {
			persian_gulf_coast = {
				type = all
				owned_by = ROOT
			}
			espakh_area = {
				type = all
				owned_by = ROOT
			}
			mogostan_area = {
				type = all
				owned_by = ROOT
			}
		}

		effect = {
			add_treasury = 10
		}
	}
	tm_PER_branch3_mission_4 = {
		icon = placeholder
		position = 5
		required_missions = { tm_PER_branch3_mission_3 }

		provinces_to_highlight = {
			region = persia_region
		}

		trigger = {
			persia_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}

		effect = {
			add_country_modifier = {
				name = tm_PER_master_of_persia
				duration = -1
			}
		}
	}
}

tm_PER_branch_4 = {
	slot = 4
	generic = no
	ai = yes

	has_country_shield = yes

	potential = {
		tag = PER
	}

	tm_PER_branch4_mission_1 = {
		icon = placeholder
		position = 1
		required_missions = {}

		trigger = {
			army_size_percentage = 1
			has_global_modifier_value = {
				which = land_morale 
				value = 0.30
			}
		}

		effect = {
			persia_region = {				
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}	
		}
	}
	
	tm_PER_branch4_mission_2 = {
		icon = placeholder
		position = 2
		required_missions = { tm_PER_branch4_mission_1 }

		provinces_to_highlight = {
			OR = {
				area = iraq_e_ajam_area 
				area = isfahan_area
				area = yazd_area
				area = zavareh_area
				area = kerman_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}

		trigger = {
			iraq_e_ajam_area = {
				type = all
				owned_by = ROOT
			}
			isfahan_area = {
				type = all
				owned_by = ROOT
			}
			yazd_area = {
				type = all
				owned_by = ROOT
			}
			zavareh_area = {
				type = all
				owned_by = ROOT
			}
			kerman_area = {
				type = all
				owned_by = ROOT
			}
		}

		effect = {
			add_treasury = 200
			khorasan_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
		}
	}
}

tm_PER_branch_5 = {
	slot = 5
	generic = no
	ai = yes

	has_country_shield = yes

	potential = {
		tag = PER
	}

	tm_PER_branch5_mission_1 = {
		icon = placeholder
		position = 2
		required_missions = { tm_PER_branch4_mission_1 }

		provinces_to_highlight = {
			area = tabarestan_area 
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}

		trigger = {
			tabarestan_area = {
				type = all
				owned_by = ROOT
			}
		}

		effect = {
			4341 = {
				add_province_modifier = {
					name = tm_PER_honor_the_dabuyids
					duration = 7300
				}
			}
			add_mercantilism = 15
		}
	}
}